c     program vspherdrv
c ... driver to run vspher
c     implicit double precision(a-h,o-z)

c     read(5,*)r

c     call vspher(r,vpot)

c     write(6,*)vpot

c     end
      subroutine vspher(r,vpot)
c ... spherically averaged potential for H2O-pH2
      implicit double precision(a-h,o-z)
      parameter(maxrpt=500)
      dimension vtable(0:maxrpt)
      data vtable/
     +  2.79985702E+04,
     +  2.61504272E+04,
     +  2.42798117E+04,
     +  2.24299694E+04,
     +  2.06441460E+04,
     +  1.89655870E+04,
     +  1.74355875E+04,
     +  1.60618210E+04,
     +  1.48236054E+04,
     +  1.36993711E+04,
     +  1.26675480E+04,
     +  1.17065745E+04,
     +  1.08001301E+04,
     +  9.94614926E+03,
     +  9.14496685E+03,
     +  8.39691769E+03,
     +  7.70233663E+03,
     +  7.06131287E+03,
     +  6.47136066E+03,
     +  5.92845726E+03,
     +  5.42855934E+03,
     +  4.96762361E+03,
     +  4.54161358E+03,
     +  4.14723608E+03,
     +  3.78259929E+03,
     +  3.44596658E+03,
     +  3.13560136E+03,
     +  2.84976702E+03,
     +  2.58675245E+03,
     +  2.34502000E+03,
     +  2.12310421E+03,
     +  1.91953990E+03,
     +  1.73286187E+03,
     +  1.56161014E+03,
     +  1.40453891E+03,
     +  1.26068698E+03,
     +  1.12911286E+03,
     +  1.00887504E+03,
     +  8.99032029E+02,
     +  7.98686204E+02,
     +  7.07139923E+02,
     +  6.23752492E+02,
     +  5.47883221E+02,
     +  4.78891421E+02,
     +  4.16142000E+02,
     +  3.59116347E+02,
     +  3.07405915E+02,
     +  2.60606467E+02,
     +  2.18313767E+02,
     +  1.80123593E+02,
     +  1.45662571E+02,
     +  1.14652557E+02,
     +  8.68337301E+01,
     +  6.19462663E+01,
     +  3.97303435E+01,
     +  1.99300618E+01,
     +  2.33760663E+00,
     + -1.32225917E+01,
     + -2.69255077E+01,
     + -3.89461162E+01,
     + -4.94592764E+01,
     + -5.86200660E+01,
     + -6.65415194E+01,
     + -7.33312932E+01,
     + -7.90970439E+01,
     + -8.39464280E+01,
     + -8.79837341E+01,
     + -9.12869194E+01,
     + -9.39215523E+01,
     + -9.59531288E+01,
     + -9.74471450E+01,
     + -9.84689290E+01,
     + -9.90747096E+01,
     + -9.93071458E+01,
     + -9.92077896E+01,
     + -9.88181931E+01,
     + -9.81799084E+01,
     + -9.73314228E+01,
     + -9.62952935E+01,
     + -9.50889174E+01,
     + -9.37296889E+01,
     + -9.22350024E+01,
     + -9.06222682E+01,
     + -8.89093021E+01,
     + -8.71143493E+01,
     + -8.52556755E+01,
     + -8.33515466E+01,
     + -8.14202283E+01,
     + -7.94773180E+01,
     + -7.75290445E+01,
     + -7.55795807E+01,
     + -7.36330995E+01,
     + -7.16937739E+01,
     + -6.97657900E+01,
     + -6.78535208E+01,
     + -6.59614807E+01,
     + -6.40941872E+01,
     + -6.22561580E+01,
     + -6.04519069E+01,
     + -5.86847767E+01,
     + -5.69552981E+01,
     + -5.52635884E+01,
     + -5.36097650E+01,
     + -5.19939453E+01,
     + -5.04162577E+01,
     + -4.88769329E+01,
     + -4.73762556E+01,
     + -4.59145110E+01,
     + -4.44919841E+01,
     + -4.31089550E+01,
     + -4.17653157E+01,
     + -4.04603087E+01,
     + -3.91931142E+01,
     + -3.79629126E+01,
     + -3.67688842E+01,
     + -3.56102144E+01,
     + -3.44861186E+01,
     + -3.33958232E+01,
     + -3.23385548E+01,
     + -3.13135397E+01,
     + -3.03200055E+01,
     + -2.93572143E+01,
     + -2.84244696E+01,
     + -2.75210768E+01,
     + -2.66463416E+01,
     + -2.57995697E+01,
     + -2.49800667E+01,
     + -2.41871382E+01,
     + -2.34200899E+01,
     + -2.26782275E+01,
     + -2.19608566E+01,
     + -2.12672853E+01,
     + -2.05968651E+01,
     + -1.99489841E+01,
     + -1.93230316E+01,
     + -1.87183968E+01,
     + -1.81344689E+01,
     + -1.75706370E+01,
     + -1.70262905E+01,
     + -1.65008186E+01,
     + -1.59936104E+01,
     + -1.55040552E+01,
     + -1.50315432E+01,
     + -1.45754736E+01,
     + -1.41352514E+01,
     + -1.37102817E+01,
     + -1.32999693E+01,
     + -1.29037194E+01,
     + -1.25209369E+01,
     + -1.21510267E+01,
     + -1.17933940E+01,
     + -1.14474437E+01,
     + -1.11125808E+01,
     + -1.07882424E+01,
     + -1.04740842E+01,
     + -1.01698526E+01,
     + -9.87529477E+00,
     + -9.59015744E+00,
     + -9.31418755E+00,
     + -9.04713200E+00,
     + -8.78873769E+00,
     + -8.53875152E+00,
     + -8.29692040E+00,
     + -8.06299121E+00,
     + -7.83671086E+00,
     + -7.61782625E+00,
     + -7.40608429E+00,
     + -7.20123187E+00,
     + -7.00301588E+00,
     + -6.81118324E+00,
     + -6.62548084E+00,
     + -6.44565559E+00,
     + -6.27145437E+00,
     + -6.10262410E+00,
     + -5.93891168E+00,
     + -5.78009283E+00,
     + -5.62603214E+00,
     + -5.47661130E+00,
     + -5.33171202E+00,
     + -5.19121599E+00,
     + -5.05500490E+00,
     + -4.92296045E+00,
     + -4.79496435E+00,
     + -4.67089827E+00,
     + -4.55064393E+00,
     + -4.43408302E+00,
     + -4.32109723E+00,
     + -4.21156825E+00,
     + -4.10537780E+00,
     + -4.00240756E+00,
     + -3.90253922E+00,
     + -3.80565449E+00,
     + -3.71163507E+00,
     + -3.62036264E+00,
     + -3.53171890E+00,
     + -3.44558556E+00,
     + -3.36184476E+00,
     + -3.28040337E+00,
     + -3.20120511E+00,
     + -3.12419672E+00,
     + -3.04932493E+00,
     + -2.97653646E+00,
     + -2.90577805E+00,
     + -2.83699643E+00,
     + -2.77013832E+00,
     + -2.70515046E+00,
     + -2.64197959E+00,
     + -2.58057242E+00,
     + -2.52087569E+00,
     + -2.46283614E+00,
     + -2.40640048E+00,
     + -2.35151546E+00,
     + -2.29812780E+00,
     + -2.24618424E+00,
     + -2.19563150E+00,
     + -2.14641631E+00,
     + -2.09848541E+00,
     + -2.05178553E+00,
     + -2.00626446E+00,
     + -1.96188554E+00,
     + -1.91862376E+00,
     + -1.87645440E+00,
     + -1.83535275E+00,
     + -1.79529408E+00,
     + -1.75625369E+00,
     + -1.71820686E+00,
     + -1.68112886E+00,
     + -1.64499499E+00,
     + -1.60978052E+00,
     + -1.57546073E+00,
     + -1.54201092E+00,
     + -1.50940637E+00,
     + -1.47762235E+00,
     + -1.44663415E+00,
     + -1.41641705E+00,
     + -1.38694634E+00,
     + -1.35819731E+00,
     + -1.33014522E+00,
     + -1.30276537E+00,
     + -1.27603304E+00,
     + -1.24992483E+00,
     + -1.22442517E+00,
     + -1.19952136E+00,
     + -1.17520073E+00,
     + -1.15145058E+00,
     + -1.12825823E+00,
     + -1.10561099E+00,
     + -1.08349617E+00,
     + -1.06190108E+00,
     + -1.04081303E+00,
     + -1.02021935E+00,
     + -1.00010734E+00,
     + -9.80464307E-01,
     + -9.61277574E-01,
     + -9.42534451E-01,
     + -9.24222249E-01,
     + -9.06328281E-01,
     + -8.88839859E-01,
     + -8.71744297E-01,
     + -8.55028907E-01,
     + -8.38681002E-01,
     + -8.22687895E-01,
     + -8.07038393E-01,
     + -7.91725354E-01,
     + -7.76742318E-01,
     + -7.62082825E-01,
     + -7.47740417E-01,
     + -7.33708635E-01,
     + -7.19981018E-01,
     + -7.06551108E-01,
     + -6.93412444E-01,
     + -6.80558569E-01,
     + -6.67983022E-01,
     + -6.55679344E-01,
     + -6.43641076E-01,
     + -6.31861758E-01,
     + -6.20334931E-01,
     + -6.09054136E-01,
     + -5.98012914E-01,
     + -5.87204804E-01,
     + -5.76623348E-01,
     + -5.66262086E-01,
     + -5.56114559E-01,
     + -5.46174336E-01,
     + -5.36436109E-01,
     + -5.26896068E-01,
     + -5.17550507E-01,
     + -5.08395718E-01,
     + -4.99427994E-01,
     + -4.90643628E-01,
     + -4.82038914E-01,
     + -4.73610144E-01,
     + -4.65353611E-01,
     + -4.57265609E-01,
     + -4.49342430E-01,
     + -4.41580367E-01,
     + -4.33975714E-01,
     + -4.26524762E-01,
     + -4.19223806E-01,
     + -4.12069139E-01,
     + -4.05057053E-01,
     + -3.98183841E-01,
     + -3.91445796E-01,
     + -3.84839211E-01,
     + -3.78360380E-01,
     + -3.72005669E-01,
     + -3.65772344E-01,
     + -3.59658277E-01,
     + -3.53661348E-01,
     + -3.47779440E-01,
     + -3.42010435E-01,
     + -3.36352213E-01,
     + -3.30802658E-01,
     + -3.25359650E-01,
     + -3.20021072E-01,
     + -3.14784805E-01,
     + -3.09648731E-01,
     + -3.04610731E-01,
     + -2.99668688E-01,
     + -2.94820483E-01,
     + -2.90063998E-01,
     + -2.85397114E-01,
     + -2.80817714E-01,
     + -2.76323680E-01,
     + -2.71912892E-01,
     + -2.67583232E-01,
     + -2.63332583E-01,
     + -2.59158934E-01,
     + -2.55060831E-01,
     + -2.51037005E-01,
     + -2.47086182E-01,
     + -2.43207091E-01,
     + -2.39398461E-01,
     + -2.35659021E-01,
     + -2.31987499E-01,
     + -2.28382623E-01,
     + -2.24843121E-01,
     + -2.21367723E-01,
     + -2.17955157E-01,
     + -2.14604151E-01,
     + -2.11313433E-01,
     + -2.08081733E-01,
     + -2.04907778E-01,
     + -2.01790298E-01,
     + -1.98728020E-01,
     + -1.95719673E-01,
     + -1.92763986E-01,
     + -1.89859687E-01,
     + -1.87005505E-01,
     + -1.84200300E-01,
     + -1.81443247E-01,
     + -1.78733570E-01,
     + -1.76070489E-01,
     + -1.73453226E-01,
     + -1.70881004E-01,
     + -1.68353044E-01,
     + -1.65868568E-01,
     + -1.63426798E-01,
     + -1.61026957E-01,
     + -1.58668265E-01,
     + -1.56349945E-01,
     + -1.54071219E-01,
     + -1.51831309E-01,
     + -1.49629436E-01,
     + -1.47464823E-01,
     + -1.45336691E-01,
     + -1.43244262E-01,
     + -1.41186759E-01,
     + -1.39163403E-01,
     + -1.37173416E-01,
     + -1.35216024E-01,
     + -1.33290579E-01,
     + -1.31396582E-01,
     + -1.29533544E-01,
     + -1.27700974E-01,
     + -1.25898383E-01,
     + -1.24125281E-01,
     + -1.22381178E-01,
     + -1.20665583E-01,
     + -1.18978008E-01,
     + -1.17317962E-01,
     + -1.15684955E-01,
     + -1.14078497E-01,
     + -1.12498100E-01,
     + -1.10943271E-01,
     + -1.09413523E-01,
     + -1.07908364E-01,
     + -1.06427306E-01,
     + -1.04969857E-01,
     + -1.03535529E-01,
     + -1.02123831E-01,
     + -1.00734273E-01,
     + -9.93663763E-02,
     + -9.80197622E-02,
     + -9.66941157E-02,
     + -9.53891218E-02,
     + -9.41044656E-02,
     + -9.28398323E-02,
     + -9.15949069E-02,
     + -9.03693746E-02,
     + -8.91629205E-02,
     + -8.79752297E-02,
     + -8.68059874E-02,
     + -8.56548785E-02,
     + -8.45215884E-02,
     + -8.34058020E-02,
     + -8.23072045E-02,
     + -8.12254811E-02,
     + -8.01603167E-02,
     + -7.91113966E-02,
     + -7.80784059E-02,
     + -7.70610296E-02,
     + -7.60589529E-02,
     + -7.50718610E-02,
     + -7.40994546E-02,
     + -7.31415065E-02,
     + -7.21978100E-02,
     + -7.12681581E-02,
     + -7.03523440E-02,
     + -6.94501610E-02,
     + -6.85614023E-02,
     + -6.76858609E-02,
     + -6.68233302E-02,
     + -6.59736032E-02,
     + -6.51364731E-02,
     + -6.43117332E-02,
     + -6.34991767E-02,
     + -6.26985966E-02,
     + -6.19097863E-02,
     + -6.11325388E-02,
     + -6.03666473E-02,
     + -5.96119051E-02,
     + -5.88681054E-02,
     + -5.81350412E-02,
     + -5.74125058E-02,
     + -5.67002925E-02,
     + -5.59982149E-02,
     + -5.53061296E-02,
     + -5.46238987E-02,
     + -5.39513845E-02,
     + -5.32884491E-02,
     + -5.26349546E-02,
     + -5.19907631E-02,
     + -5.13557370E-02,
     + -5.07297382E-02,
     + -5.01126290E-02,
     + -4.95042715E-02,
     + -4.89045280E-02,
     + -4.83132604E-02,
     + -4.77303310E-02,
     + -4.71556020E-02,
     + -4.65889355E-02,
     + -4.60301937E-02,
     + -4.54792387E-02,
     + -4.49359326E-02,
     + -4.44001377E-02,
     + -4.38717161E-02,
     + -4.33505308E-02,
     + -4.28364643E-02,
     + -4.23294206E-02,
     + -4.18293041E-02,
     + -4.13360197E-02,
     + -4.08494720E-02,
     + -4.03695656E-02,
     + -3.98962054E-02,
     + -3.94292960E-02,
     + -3.89687420E-02,
     + -3.85144482E-02,
     + -3.80663192E-02,
     + -3.76242598E-02,
     + -3.71881746E-02,
     + -3.67579683E-02,
     + -3.63335457E-02,
     + -3.59148113E-02,
     + -3.55016699E-02,
     + -3.50940262E-02,
     + -3.46917849E-02,
     + -3.42948506E-02,
     + -3.39031281E-02,
     + -3.35165244E-02,
     + -3.31349681E-02,
     + -3.27583991E-02,
     + -3.23867575E-02,
     + -3.20199833E-02,
     + -3.16580166E-02,
     + -3.13007975E-02,
     + -3.09482659E-02,
     + -3.06003621E-02,
     + -3.02570259E-02,
     + -2.99181975E-02,
     + -2.95838169E-02,
     + -2.92538242E-02,
     + -2.89281595E-02,
     + -2.86067627E-02,
     + -2.82895740E-02,
     + -2.79765334E-02,
     + -2.76675809E-02,
     + -2.73626566E-02,
     + -2.70617007E-02,
     + -2.67646530E-02,
     + -2.64714537E-02/

      parameter(r0=3.d0,rmax=26.d0,rstep=0.046d0,ang2bo=0.5291772)

c ... convert r to the unit of bohr
      r=r/ang2bo

      if(r.lt.r0) r=r0
      if(r.gt.rmax)r=rmax

      ir=int((r-r0)/rstep)

      v0=vtable(ir)

      if(ir.eq.maxrpt) then
        gradr=0.0
        delr=0.0
      else
        irp=ir+1
        gradr=(vtable(irp)-v0)/rstep
        delr=r-(r0+ir*rstep)
      endif

      vpot=v0+gradr*delr

      return
      end
